<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <title>Gestion CV Sopra Steria</title>
    <link rel="stylesheet" href="./style.css">

<body>

    <div class="header">
        <h3>Bienvenue sur l'IHM de Gestion de CV Sopra Steria</h3>
    </div>

    <div class="middle">
        <label class="switch">
            <input type="checkbox">
            <span class="slider round"></span>
        </label>
        <p> Activer la fonction fuzzy wuzzy</p>
    </div>

    <div class="footer">
        <input type="file" name="upfile" />
        <button class="validate" type="button" onclick="SendPost()"><a>Valider</a></button>
    </div>
    <button class="validate" type="button" onclick="afficherLocalStorage()"><a>afficher local storage</a></button>
    <button class="validate" type="button" onclick="EmptyLocalStorage()"><a>vider local storage</a></button>

</body>


<script>

    window.onload = function () {
        //EmptyLocalStorage();
    };


    function afficherLocalStorage() {
        local = localStorage.getItem('resumes_parsed');
        localJson = JSON.stringify(local);
        console.log(local);
    }

    function EmptyLocalStorage() {
        localStorage.removeItem('resumes_parsed');

    }
    async function SendPost() {
        console.log("inside SendPost");
        var fileInput = document.querySelector('input[type="file"]')
        var formdata = new FormData();
        formdata.append("files[]", fileInput.files[0]);
        formdata.append("fuzzy", "False");

        var requestOptions = {
            method: 'POST',
            body: formdata,
            redirect: 'follow'
        };

        const response = await fetch("http://127.0.0.1:2000/resume-parser?files[]=", requestOptions)
            .then(response => response.json())
            .then(result => {
                console.log(result);
                localStorage.setItem("resumes_parsed", JSON.stringify(result));
            })
            .catch(error => console.log('error', error));

    }





</script>